<section>
  <div class="home-hero">
    <div class="home-hero__inner">
      <div>
        {% if section.settings.eyebrow != blank %}
          <p class="home-hero__eyebrow">{{ section.settings.eyebrow }}</p>
        {% endif %}

        <h1 class="home-hero__title">
          {{ section.settings.heading | escape }}
        </h1>

        {% if section.settings.subheading != blank %}
          <p class="home-hero__subtitle">{{ section.settings.subheading }}</p>
        {% endif %}

        <div class="home-hero__cta-row">
          {% if section.settings.primary_label != blank %}
            <a href="{{ section.settings.primary_link | default: '/collections/all' }}" class="btn btn--primary">
              {{ section.settings.primary_label }}
            </a>
          {% endif %}
          {% if section.settings.secondary_label != blank %}
            <a href="{{ section.settings.secondary_link | default: '/collections/climbing' }}" class="btn btn--ghost">
              {{ section.settings.secondary_label }}
            </a>
          {% endif %}
        </div>

        <div class="home-hero__meta">
          {% if section.settings.meta_1 != blank %}
            <span>{{ section.settings.meta_1 }}</span>
          {% endif %}
          {% if section.settings.meta_2 != blank %}
            <span>{{ section.settings.meta_2 }}</span>
          {% endif %}
        </div>
      </div>

      <div class="home-hero__media">
        {% if section.settings.hero_image %}
          <img
            src="{{ section.settings.hero_image | image_url: width: 1200 }}"
            alt="{{ section.settings.hero_image.alt | default: 'Hero image' | escape }}"
          >
        {% else %}
          <!-- Fallback grey box -->
        {% endif %}
      </div>
    </div>
  </div>

  <div class="home-categories">
    <div class="home-categories__grid">
      {% for block in section.blocks %}
        {% if block.type == 'category' %}
          <a href="{{ block.settings.link | default: '/collections/all' }}" class="category-card" {{ block.shopify_attributes }}>
            <div class="category-card__image">
              {% if block.settings.image %}
                <img
                  src="{{ block.settings.image | image_url: width: 800 }}"
                  alt="{{ block.settings.title | escape }}"
                  style="object-fit: cover; width: 100%; height: 100%; position:absolute; top:0; left:0;"
                >
              {% endif %}
            </div>
            <div class="category-card__body">
              {% if block.settings.eyebrow != blank %}
                <div class="category-card__eyebrow">{{ block.settings.eyebrow }}</div>
              {% endif %}
              <div class="category-card__title">{{ block.settings.title }}</div>
              <div class="category-card__link">{{ block.settings.link_label }}</div>
            </div>
          </a>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  {% if section.settings.featured_collection != blank %}
    {% assign coll = collections[section.settings.featured_collection] %}
    {% if coll and coll.products_count > 0 %}
      <div class="home-products">
        <div class="section-heading">
          <div class="section-heading__title">{{ section.settings.products_heading }}</div>
          <div class="section-heading__subtitle">{{ section.settings.products_subheading }}</div>
        </div>
        <div class="product-grid">
          {% for product in coll.products limit: section.settings.products_limit %}
            <article class="product-card">
              <a href="{{ product.url }}" class="product-card__media">
                {% if product.featured_media %}
                  {{ product.featured_media
                    | image_url: width: 600
                    | image_tag: loading: 'lazy', alt: product.title }}
                {% endif %}
              </a>
              <div class="product-card__body">
                <div class="product-card__title">{{ product.title }}</div>
                <div class="product-card__price">{{ product.price | money }}</div>
              </div>
            </article>
          {% endfor %}
        </div>
      </div>
    {% endif %}
  {% endif %}
</section>

{% schema %}
{
  "name": "La-style home",
  "settings": [
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero image"
    },
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow",
      "default": "Performance in the mountains"
    },
    {
      "type": "textarea",
      "id": "heading",
      "label": "Main heading",
      "default": "Climb higher. Run further. Recover better."
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Technical footwear and equipment for climbers and outdoor athletes who live for vertical terrain."
    },
    {
      "type": "text",
      "id": "primary_label",
      "label": "Primary button label",
      "default": "Shop climbing"
    },
    {
      "type": "url",
      "id": "primary_link",
      "label": "Primary button link"
    },
    {
      "type": "text",
      "id": "secondary_label",
      "label": "Secondary button label",
      "default": "Shop all"
    },
    {
      "type": "url",
      "id": "secondary_link",
      "label": "Secondary button link"
    },
    {
      "type": "text",
      "id": "meta_1",
      "label": "Meta line 1",
      "default": "Free shipping over $99"
    },
    {
      "type": "text",
      "id": "meta_2",
      "label": "Meta line 2",
      "default": "Designed for rock, trail & alpine"
    },
    {
      "type": "collection",
      "id": "featured_collection",
      "label": "Featured collection"
    },
    {
      "type": "text",
      "id": "products_heading",
      "label": "Products heading",
      "default": "Featured gear"
    },
    {
      "type": "textarea",
      "id": "products_subheading",
      "label": "Products subheading",
      "default": "Handpicked shoes and equipment ready for your next project."
    },
    {
      "type": "range",
      "id": "products_limit",
      "label": "Number of products",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 4
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category tile",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Tile image"
        },
        {
          "type": "text",
          "id": "eyebrow",
          "label": "Eyebrow",
          "default": "Category"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Climbing"
        },
        {
          "type": "text",
          "id": "link_label",
          "label": "Link label",
          "default": "Shop now"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "La-style home",
      "category": "Custom",
      "blocks": [
        {
          "type": "category",
          "settings": {
            "eyebrow": "Climb",
            "title": "Climbing shoes",
            "link_label": "Shop climbing"
          }
        },
        {
          "type": "category",
          "settings": {
            "eyebrow": "Run",
            "title": "Trail running",
            "link_label": "Shop running"
          }
        },
        {
          "type": "category",
          "settings": {
            "eyebrow": "Explore",
            "title": "Hiking & approach",
            "link_label": "Shop hiking"
          }
        }
      ]
    }
  ]
}
{% endschema %}
